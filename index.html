<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Oscar-Lucas Medrano</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: black;
      overflow: hidden;
      width: 100%;
      height: 100%;
    }

    #viewer {
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: center;
      width: 100vw;
      height: 100vh;
      gap: 4px;
    }

    canvas {
      background: white;
      box-shadow: 0 0 20px rgba(0,0,0,0.7);
      max-height: 95vh;
      height: auto;
      width: auto;
    }

    @media (max-width: 768px) {
      #viewer {
        flex-direction: row; /* force horizontal like a book */
        gap: 2px;
        overflow-x: scroll;
        padding: 10px;
      }
      canvas {
        max-width: 48vw;
        height: auto;
      }
    }
  </style>
</head>
<body>
  <div id="viewer"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script>
    const pdfs = [
      'page1.pdf',
      'about.pdf',
      'table_of_contents.pdf',
      'page4.pdf',
      'page5.pdf'
    ];

    const viewer = document.getElementById('viewer');
    const pdfjsLib = window['pdfjs-dist/build/pdf'];
    let currentPage = 0;
    let maxHeight = 0;

    const renderPDF = async (url) => {
      const pdf = await pdfjsLib.getDocument(url).promise;
      const page = await pdf.getPage(1);
      const viewport = page.getViewport({ scale: 2.5 });
      return { pdf, page, viewport };
    };

    const drawCanvas = async (pdfObj, forcedHeight = null) => {
      const canvas = document.createElement('canvas');
      const context = canvas.getContext('2d');
      let scale = 2.5;
      if (forcedHeight) {
        scale = forcedHeight / pdfObj.viewport.height;
      }
      const viewport = pdfObj.page.getViewport({ scale });

      canvas.width = viewport.width;
      canvas.height = viewport.height;

      await pdfObj.page.render({
        canvasContext: context,
        viewport
      }).promise;

      return canvas;
    };

    const updateViewer = async () => {
      viewer.innerHTML = '';

      const isCover = currentPage === 0;
      if (isCover) {
        const pdfObj = await renderPDF(pdfs[0]);
        const canvas = await drawCanvas(pdfObj);
        viewer.appendChild(canvas);
        maxHeight = canvas.height;
      } else {
        const leftPDF = await renderPDF(pdfs[currentPage]);
        const rightPDF = pdfs[currentPage + 1] ? await renderPDF(pdfs[currentPage + 1]) : null;

        const targetHeight = Math.max(leftPDF.viewport.height, rightPDF?.viewport.height || 0);
        const canvasLeft = await drawCanvas(leftPDF, targetHeight);
        const canvasRight = rightPDF ? await drawCanvas(rightPDF, targetHeight) : null;

        viewer.appendChild(canvasLeft);
        if (canvasRight) viewer.appendChild(canvasRight);

        maxHeight = targetHeight;
      }
    };

    const next = () => {
      if (currentPage === 0) currentPage = 1;
      else if (currentPage + 2 < pdfs.length) currentPage += 2;
      updateViewer();
    };

    const prev = () => {
      if (currentPage <= 1) currentPage = 0;
      else currentPage -= 2;
      updateViewer();
    };

    window.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowRight') next();
      if (e.key === 'ArrowLeft') prev();
    });

    viewer.addEventListener('click', next);

    updateViewer();
  </script>
</body>
</html>

