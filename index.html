<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Simple PDF Flipbook</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            background-color: black;
            height: 100vh;
            width: 100vw;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        #container {
            position: relative;
            text-align: center;
        }
        #pdf-canvas {
            width: 574.43px;
            height: auto;
            border: 1px solid white;
            display: block;
            margin: 0 auto;
        }
        #nav-buttons {
            position: absolute;
            top: 50%;
            width: 100%;
            display: flex;
            justify-content: space-between;
            transform: translateY(-50%);
        }
        .nav-button {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 10px;
            width: 50px;
        }
        .nav-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div id="container">
        <canvas id="pdf-canvas"></canvas>
        <div id="nav-buttons">
            <button id="prev-btn" class="nav-button">&larr;</button>
            <button id="next-btn" class="nav-button">&rarr;</button>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js';

        const pdfFiles = [
            'page1.pdf', 'page2.pdf', 'page3.pdf', 'page4.pdf', 'page5.pdf',
            'page6.pdf', 'page7.pdf', 'page8.pdf', 'page9.pdf', 'page10.pdf',
            'page11.pdf', 'page12.pdf', 'page13.pdf', 'page14.pdf', 'page15.pdf',
            'page16.pdf', 'page17.pdf', 'page18.pdf', 'page19.pdf', 'page20.pdf',
            'page21.pdf', 'page22.pdf', 'page23.pdf', 'page24.pdf', 'page25.pdf',
            'page26.pdf', 'page27.pdf', 'page28.pdf', 'page29.pdf', 'page30.pdf',
            'page31.pdf', 'page32.pdf', 'page33.pdf'
        ];
        let currentIndex = 0;
        const canvas = document.getElementById('pdf-canvas');
        const context = canvas.getContext('2d');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        let scale = 1.0;
        const TARGET_WIDTH = 574.43;
        const minScale = 0.1;
        const maxScale = 5.0;

        async function loadPage(index) {
            context.clearRect(0, 0, canvas.width, canvas.height);
            const pdfDoc = await pdfjsLib.getDocument(pdfFiles[index]).promise;
            const page = await pdfDoc.getPage(1);
            const viewport = page.getViewport({ scale: 1.0 });
            scale = TARGET_WIDTH / viewport.width;
            const adjustedViewport = page.getViewport({ scale: scale });
            canvas.height = adjustedViewport.height;
            canvas.width = adjustedViewport.width;
            canvas.style.width = `${TARGET_WIDTH}px`;
            canvas.style.height = `${adjustedViewport.height}px`;
            const renderContext = {
                canvasContext: context,
                viewport: adjustedViewport
            };
            await page.render(renderContext).promise;
            console.log(`Loaded page: ${pdfFiles[index]}, rendered width: ${TARGET_WIDTH}px, rendered height: ${adjustedViewport.height}px`);
            updateButtons();
        }

        function updateButtons() {
            prevBtn.disabled = currentIndex === 0;
            nextBtn.disabled = currentIndex === pdfFiles.length - 1;
        }

        prevBtn.addEventListener('click', () => {
            if (currentIndex > 0) {
                currentIndex--;
                loadPage(currentIndex);
            }
        });

        nextBtn.addEventListener('click', () => {
            if (currentIndex < pdfFiles.length - 1) {
                currentIndex++;
                loadPage(currentIndex);
            }
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft' && currentIndex > 0) {
                currentIndex--;
                loadPage(currentIndex);
            } else if (e.key === 'ArrowRight' && currentIndex < pdfFiles.length - 1) {
                currentIndex++;
                loadPage(currentIndex);
            }
        });

        // Mouse wheel zoom
        canvas.addEventListener('wheel', (e) => {
            e.preventDefault();
            const delta = e.deltaY * -0.001;
            scale = Math.min(maxScale, Math.max(minScale, scale + delta));
            renderZoomed();
        });

        // Mobile pinch zoom
        let lastTouchDistance = 0;
        canvas.addEventListener('touchstart', (e) => {
            if (e.touches.length === 2) {
                e.preventDefault();
                const touch1 = e.touches[0];
                const touch2 = e.touches[1];
                lastTouchDistance = Math.hypot(touch2.pageX - touch1.pageX, touch2.pageY - touch1.pageY);
            }
        });

        canvas.addEventListener('touchmove', (e) => {
            if (e.touches.length === 2) {
                e.preventDefault();
                const touch1 = e.touches[0];
                const touch2 = e.touches[1];
                const currentDistance = Math.hypot(touch2.pageX - touch1.pageX, touch2.pageY - touch1.pageY);
                const delta = (currentDistance - lastTouchDistance) * 0.01;
                scale = Math.min(maxScale, Math.max(minScale, scale + delta));
                lastTouchDistance = currentDistance;
                renderZoomed();
            }
        });

        function renderZoomed() {
            loadPage(currentIndex);
        }

        window.addEventListener('resize', () => loadPage(currentIndex));

        loadPage(currentIndex);
    </script>
</body>
</html>